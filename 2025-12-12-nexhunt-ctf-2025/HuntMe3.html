<!-- https://raw.githubusercontent.com/mkdocs/mkdocs/refs/heads/master/mkdocs/themes/mkdocs/base.html -->
<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://jia.je/ctf-writeups/2025-12-12-nexhunt-ctf-2025/HuntMe3.html">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>HuntMe3 - CTF Writeups by @jiegec</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <!-- added by @jiegec begin -->
        <link href=" https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism.min.css " rel="stylesheet">
        <!-- added by @jiegec end -->
        <!-- added by @jiegec begin -->
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/prism-core.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <!-- added by @jiegec end -->

      <!-- added by @jiegec begin -->
      <script defer src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
      </script>
      
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-3109FRSVTT"></script>
      <script>
          window.dataLayer = window.dataLayer || [];
          function gtag() { dataLayer.push(arguments); }
          gtag('js', new Date());
      
          gtag('config', 'G-3109FRSVTT');
      </script>
      
      <script src="https://analytics.jiege.pro/api/script.js" data-site-id="1" defer></script>
      <!-- added by @jiegec end --> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../index.html">CTF Writeups by @jiegec</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../index.html" class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../misc/solution.html" class="nav-link">Writeups by Solution</a>
                            </li>
                            <li class="nav-item">
                                <a href="../misc/pyjail.html" class="nav-link">Pyjail</a>
                            </li>
                            <li class="nav-item">
                                <a href="../puppeteer/index.html" class="nav-link">Redbud Puppeteer</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#huntme3" class="nav-link">HuntMe3</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#huntme3-ctf-challenge-solution" class="nav-link">HuntMe3 CTF Challenge Solution</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#challenge-analysis" class="nav-link">Challenge Analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#binary-analysis" class="nav-link">Binary Analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#reverse-engineering-process" class="nav-link">Reverse Engineering Process</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#solution" class="nav-link">Solution</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#flag" class="nav-link">Flag</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#exploit-script" class="nav-link">Exploit Script</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#testing" class="nav-link">Testing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="huntme3">HuntMe3</h1>
<pre class="highlight"><code>The forest is no longer just watched.
Now, every step you take is measured.
Every wrong move is quietly absorbed by the trees.
Only those who truly understand the pattern may pass.

Author : N!L</code></pre>
<p>Attack script written by AI agent:</p>
<pre class="highlight"><code class="language-python">#!/usr/bin/env python3

# Data from the binary
permutation = [
    0x2d, 0x2c, 0x32, 0x14, 0x6, 0x25, 0xf, 0x3, 0x22, 0x7, 
    0x2f, 0x23, 0x0, 0x31, 0x1c, 0x27, 0x10, 0x2, 0x30, 0xa, 
    0x2a, 0x16, 0x5, 0x12, 0x1d, 0x1, 0x9, 0x17, 0x1b, 0x1f, 
    0x1a, 0x8, 0xc, 0x24, 0x4, 0x20, 0x2e, 0x34, 0xb, 0x26, 
    0xe, 0x33, 0x15, 0x1e, 0x19, 0x29, 0x13, 0x11, 0x2b, 0x28, 
    0x21, 0xd, 0x18
]

target_xor = [
    0xc7, 0x8e, 0xb, 0xe5, 0x23, 0x81, 0x18, 0x23, 0x27, 0xed, 
    0x6, 0xa1, 0x19, 0x30, 0x38, 0xd0, 0x2e, 0x66, 0xe2, 0x26, 
    0x6e, 0x23, 0xaa, 0xa1, 0x5d, 0x7d, 0x36, 0xe5, 0x6c, 0x6d, 
    0x35, 0xa0, 0x34, 0xc, 0xf9, 0x84, 0xd7, 0xc9, 0x5e, 0x56, 
    0xc2, 0xe9, 0x44, 0xe0, 0x77, 0x7b, 0x20, 0x78, 0x1f, 0xd9, 
    0x98, 0x85, 0xf5
]

# First, let's implement sub_4012BC based on the decompiled code
def sub_4012BC(a1):
    """Implementation of sub_4012BC from decompiled code"""
    v6 = 92
    v5 = -46 &amp; 0xFF  # Convert to unsigned byte
    v4 = 359969064

    for i in range(a1 + 1):
        v6 = (v6 - 4) &amp; 0xFF
        v5 = (v5 + i * i) &amp; 0xFF
        # sub_4012A0 rotates left by (i &amp; 7) bits
        rotate_amount = i &amp; 7
        # ROL4 implementation
        v4 = ((v4 &lt;&lt; rotate_amount) | (v4 &gt;&gt; (32 - rotate_amount))) &amp; 0xFFFFFFFF

    # Calculate v2
    rotated_v4 = (v4 &gt;&gt; (a1 &amp; 7)) &amp; 0xFF
    xor_result = rotated_v4 ^ v5 ^ v6
    v2 = ((8 * xor_result) ^ xor_result) &amp; 0xFF

    # Final result
    return ((v2 &gt;&gt; 5) ^ v2) &amp; 0xFF

# We also need to consider that sub_4011B6() and sub_40120D() are called before the loop
# These might modify global state. Let me check what they do

# From decompilation:
# sub_40120D() processes byte_4020E0 and byte_402100 arrays
# sub_4011B6() might also modify some state

# Let me check if there are any global variables being modified
# Looking at the decompiled sub_40120D, it returns a value but doesn't seem to modify globals
# sub_4011B6 is small (0x57 bytes)

# Actually, looking more carefully at the validation:
# if ( ((unsigned __int8)sub_4012BC(i) ^ a1[byte_402040[i]]) != byte_402080[i] )
# So we need: a1[permutation[i]] = sub_4012BC(i) ^ target_xor[i]

# Let's compute the flag
flag_chars = [0] * 53

for i in range(53):
    key_byte = sub_4012BC(i)
    target_index = permutation[i]
    if target_index &gt;= 53:
        print(f"Warning: index {target_index} out of bounds at i={i}")
        continue
    flag_chars[target_index] = key_byte ^ target_xor[i]

# Convert to string
flag = ''.join(chr(c) for c in flag_chars)
print(f"Flag: {flag}")
print(f"Flag length: {len(flag)}")
print(f"Flag hex: {flag.encode().hex()}")</code></pre>
<p>Writeup written by AI agent:</p>
<h1 id="huntme3-ctf-challenge-solution">HuntMe3 CTF Challenge Solution</h1>
<h2 id="challenge-analysis">Challenge Analysis</h2>
<p>This is a reverse engineering challenge where we need to find the correct 53-character input that passes validation.</p>
<h2 id="binary-analysis">Binary Analysis</h2>
<p>The binary <code>HuntMe3</code> is a 64-bit ELF executable with:</p>
<ul>
<li>Partial RELRO</li>
<li>No stack canary  </li>
<li>NX enabled</li>
<li>No PIE</li>
<li>Stripped symbols</li>
</ul>
<h2 id="reverse-engineering-process">Reverse Engineering Process</h2>
<ol>
<li><strong>Main Function Analysis</strong>: The program reads input via <code>fgets()</code> and validates it using <code>sub_401367()</code>.</li>
<li><strong>Validation Logic</strong>: The validation function <code>sub_401367()</code> checks:<ul>
<li>Input length must be exactly 53 characters</li>
<li>Calls <code>sub_4011B6()</code> and <code>sub_40120D()</code> (these appear to be initialization functions)</li>
<li>For each position <code>i</code> from 0 to 52, checks:
    <pre class="highlight"><code>if (sub_4012BC(i) ^ input[permutation[i]] != target_xor[i]) return 0;</code></pre></li>
<li>Where <code>permutation</code> is an array at address <code>0x402040</code> and <code>target_xor</code> is at <code>0x402080</code></li>
</ul>
</li>
<li><strong>Key Function <code>sub_4012BC()</code></strong>: This function generates a key byte for each position <code>i</code> using:<ul>
<li>Initial values: <code>v6 = 92</code>, <code>v5 = -46</code>, <code>v4 = 359969064</code></li>
<li>Loop from 0 to <code>i</code>:<ul>
<li><code>v6 -= 4</code></li>
<li><code>v5 += i * i</code></li>
<li><code>v4 = ROL4(v4, i &amp; 7)</code> (rotate left 32-bit)</li>
</ul>
</li>
<li>Final calculation:</li>
</ul>
</li>
</ol>
<pre class="highlight"><code>rotated_v4 = (v4 &gt;&gt; (i &amp; 7)) &amp; 0xFF
xor_result = rotated_v4 ^ v5 ^ v6
v2 = (8 * xor_result) ^ xor_result
result = (v2 &gt;&gt; 5) ^ v2</code></pre>
<h2 id="solution">Solution</h2>
<p>The solution involves reconstructing the input by solving:
<pre class="highlight"><code>input[permutation[i]] = sub_4012BC(i) ^ target_xor[i]</code></pre></p>
<p>The permutation array maps each position <code>i</code> to an index in the input string, and <code>target_xor</code> contains the expected XOR result.</p>
<h2 id="flag">Flag</h2>
<p>The flag is: <code>nexus{thr33_hunt5_c0mpl3t3_th3_f0r3st_gr4nts_p4ss4g3}</code></p>
<h2 id="exploit-script">Exploit Script</h2>
<p>See <code>solve.py</code> for the complete solution implementation that:</p>
<ol>
<li>Implements the <code>sub_4012BC()</code> function logic</li>
<li>Extracts the permutation and target XOR arrays from the binary</li>
<li>Computes the correct input by solving the XOR equation</li>
<li>Reconstructs the flag in the correct order using the permutation mapping</li>
</ol>
<h2 id="testing">Testing</h2>
<p>The flag was successfully tested with the binary:</p>
<pre class="highlight"><code>echo "nexus{thr33_hunt5_c0mpl3t3_th3_f0r3st_gr4nts_p4ss4g3}" | ./HuntMe3</code></pre>
<p>This produces the success message showing "THE FOREST RECOGNIZES ITS MASTER" and "CONGRATULATIONS, MASTER HUNTER".</p></div>

                <!-- added by @jiegec begin -->
                <div class="col-md-3"></div>
                <div class="col-md-9">
                  <script src="https://giscus.app/client.js"
                      data-repo="jiegec/ctf-writeups"
                      data-repo-id="MDEwOlJlcG9zaXRvcnkxNTE1MzAxODQ="
                      data-category="General"
                      data-category-id="DIC_kwDOCQgqyM4CvbYX"
                      data-mapping="pathname"
                      data-strict="1"
                      data-reactions-enabled="1"
                      data-emit-metadata="0"
                      data-input-position="top"
                      data-theme="light"
                      data-lang="en"
                      data-loading="lazy"
                      crossorigin="anonymous"
                      async>
                  </script>
                </div>
                <!-- added by @jiegec end -->
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2025 Jiajie Chen</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
